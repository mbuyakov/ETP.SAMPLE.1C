# ETP.SAMPLE.1C

Примеры взаимодействия с IBM MQ (WebsphereMQ) из 1С Предприятие версии 8 и выше

Работать с очередями из 1С можно двумя способами: через COM объект (ActiveX) или через библиотеки .NET

##Работа через COM объект (ActiveX)

_Важно!_ Компонент COM больше не поддерживается. Работа с ним не всегда стабильная и гибкая.

Работа с IBM WebsphereMQ происходит через COM объект MQAX200

Первым делом необходимо установить клиент IBM MQ 7.5.0.4: http://www-01.ibm.com/software/integration/wmq/clients/

Официальная документация: https://www.ibm.com/support/knowledgecenter/en/SSFKSJ_7.5.0/com.ibm.mq.dev.doc/q033320_.htm

Перед началом работы необходимо установить параметры подключения к серверу с помощью переменной окружения MQSERVER
```sh
MQSERVER=CLIENT.SVRCONN/TCP/127.0.0.1(2424)
```
Примеры записи сообщения в очередь и чтения сообщения из очереди находятся в папке 1C_COM в файле 1С_WebsphereMQ_samples.1C. Исходный код приведен для системы 1С:Предприятие версии 8.0 и выше.

Так же присутствует пример обработки для 1С Предприятие 8.3
```sh
1C_COM\1С_IBMMQ.epf
```

##Работа через библиотеки .NET

Работа происходит через .NET Framework версии 4.0!

Перед началом работы удостоверьтесь что он установлен на вашем компьютере

Подготовка:

1. Необходимо из папки 1C_NET запусть приложение с правами _администратора_ RegisterLib.exe
2. В программе нажать кнопку "Регистрация сервера" и выбрать dll библиотеку _NetObjetToIDispatch45.dll_ в папке 1C_NET
3. Необходимо скопировать файлы _amqmdnet.dll_ и _amqmdxcs.dll_ из папки 1C_NET в папку _C:\Windows\Microsoft.NET\Framework\v4.0.30319_

После этого можно работать в 1С.

Параметры подключения настраиваются в процедуре и функции.

Примеры записи сообщения в очередь и чтения сообщения из очереди находятся в папке 1C_NET в файле 1С_WebsphereMQ_NET_samples.1C. Исходный код приведен для системы 1С:Предприятие версии 8.0 и выше.

Так же присутствует пример обработки для 1С Предприятие 8.3
```sh
1C_NET\1С_IBMMQ_NET.epf
```
